<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Message secret</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 400px; margin: 2rem auto; }
  #chat { border: 1px solid #ccc; padding: 1rem; height: 200px; overflow-y: auto; margin-bottom: 1rem; }
  .message { margin: 0.5rem 0; }
  .user { color: blue; }
  .bot { color: green; }
  #typing { font-style: italic; color: gray; }
</style>
</head>
<body>

<h2>Envoyer un message</h2>
<div id="chat"></div>

<input type="text" id="inputMessage" placeholder="Écris ton message..." autofocus />
<button id="sendBtn">Envoyer</button>

<script>
  const chat = document.getElementById('chat');
  const input = document.getElementById('inputMessage');
  const sendBtn = document.getElementById('sendBtn');

  const secretCode = "1234"; // code secret à détecter
  const botReply = "Le protocole a été validé. Nous vous contacterons bientôt.";

  function addMessage(text, sender) {
    const div = document.createElement('div');
    div.classList.add('message', sender);
    div.textContent = text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight; // scroll en bas
  }

  sendBtn.addEventListener('click', sendMessage);
  input.addEventListener('keypress', (e) => {
    if(e.key === 'Enter') sendMessage();
  });

  function sendMessage() {
    const msg = input.value.trim();
    if(!msg) return;
    addMessage("Toi : " + msg, 'user');
    input.value = '';

    if(msg === secretCode) {
      // Afficher "La personne écrit..."
      const typingDiv = document.createElement('div');
      typingDiv.id = "typing";
      typingDiv.textContent = "La personne est en train d'écrire...";
      chat.appendChild(typingDiv);
      chat.scrollTop = chat.scrollHeight;

      // Après 3 secondes, enlever le typing et afficher la réponse
      setTimeout(() => {
        typingDiv.remove();
        addMessage("Organisation secrète : " + botReply, 'bot');
      }, 3000);
    }
  }
</script>

</body>
</html>
